<?php
if(isset($_GET['page'])){
  $HidoveInfo = [
    'page' => $_GET['page'],
  ];
}else{
  $HidoveInfo = [
      'page' => 0,
  ];
}
include "base.html";?>
<div class="container">
<div class="panel panel-success">
   <div class="panel-heading">
	<caption>最近更新</caption>
  </div>
  <div class="panel-body">
  
	 <table class="table">
      <thead>
        <tr>
          <th>#</th>
          <th>标题</th>
          <th>地址</th>
          <th>更新时间</th>
        </tr>
      </thead>
      <tbody id="index_list">
      </tbody>
</table>
    <div id="loading" style="text-align: center;">
              正在加载中
        </div>
  </div>
</div>
</div>
<nav>
  <ul class="pager">
    <li><a href="?page=<?php echo ($HidoveInfo['page']-1)?>">Previous</a></li>
    <li><a href="?page=<?php echo ($HidoveInfo['page']+1)?>">Next</a></li>
  </ul>
</nav>
<script type="text/javascript">
var date  = new Date;
var month = date.getMonth()+1;
var day = date.getDate();
if(month<10){
  month='0'+month;
}
if(day<10){
  day='0'+day;
}
var time = month + '-' + day;
	$.ajax({
		type:'get',
		url:'api/index.php',
    data:{'page':'<?php echo $HidoveInfo['page']?>'},
    dataType:'json',
		success:function (data){
				var html = '';
				var list = eval(data);
				var list = list['data'];
			for(var index in list){
				html = html +`
			<tr>
          <th scope="row">`
          + index
          +`</th>
          <td>`
          + list[index]['title']
          +`</td>
          <td><a href="info.php?id=`
          + list[index]['url']
          +`" target="_blank">进去瞧一瞧`
          // + list[index]['url']
          +`</a></td>
          <td class = "`
          + list[index]['date']
          +`">`
          + list[index]['date']
          +`</td>
        </tr>`;
			}
      $('#index_list').html(html);
      $('.'+time).css('color','#F00');
			$('#loading').remove();
		},
    error:function(){
      html = `<div id="loading" style="text-align: center;">
              加载失败
        </div>`
      $('#loading').html(html);

    }
	});
</script>
<?php include "foot.html" ?>