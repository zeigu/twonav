<?php
$HidoveInfo=[];
if(isset($_GET['id'])){
	$HidoveInfo['id'] =  $_GET['id'];
}else{
  $HidoveInfo['id'] =  1;
}
if(isset($_GET['page'])){
  $HidoveInfo['page'] =  $_GET['page'];
}else{
  $HidoveInfo['page'] =  1;
}
 include "base.html";?>
<div class="container">
<div class="panel panel-success">
   <div class="panel-heading">
	<caption>最近更新</caption>
  </div>
  <div class="panel-body">
  
	 <table class="table">
      <thead>
        <tr>
          <th>#</th>
          <th>标题</th>
          <th>地址</th>
          <th>更新时间</th>
        </tr>
      </thead>
      <tbody id="index_list">
      </tbody>
</table>
<div id="loading" style="text-align: center;">
              正在加载中
        </div>
  </div>
</div>
</div>
<nav>
  <ul class="pager">
    <li><a href="?id=<?php echo $HidoveInfo['id']?>&page=<?php echo ($HidoveInfo['page']-1)?>">Previous</a></li>
    <li><a href="?id=<?php echo $HidoveInfo['id']?>&page=<?php echo ($HidoveInfo['page']+1)?>">Next</a></li>
  </ul>
</nav>
<script type="text/javascript">
	$.ajax({
		type:'get',
		url:'api/category.php',
    	data:{'id':'<?php echo $HidoveInfo['id']?>','page':'<?php echo $HidoveInfo['page']?>'},
    	dataType:'json',
		success:function (data){
				var html = '';
				var list = eval(data);
        $('title').text(list['category']+" - <?php echo $Hidove['title'];?>");
        if (list['code']!=1) {
          alert(list['msg']);
          window.close();
        }
		var list = list['data'];
        for(var index in list){
				html = html +`
			<tr>
          <th scope="row">`
          + index
          +`</th>
          <td>`
          + list[index]['title']
          +`</td>
          <td><a href="info.php?id=`
          + list[index]['url']
          +`" target="_blank">进去瞧一瞧`
          // + list[index]['url']
          +`</a></td>
          <td>`
          + list[index]['date']
          +`</td>
        </tr>`;
			}
      $('#loading').remove();
        $('#index_list').html(html);
      },
   error:function (data){
      console.log(data);
      html = `<div id="loading" style="text-align: center;">
              加载失败
        </div>`
      $('#loading').html(html);

    }
	});
 
</script>
<?php include "foot.html" ?>